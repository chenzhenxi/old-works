function PxLoaderImage(a,b,c){var d=this,e=null;this.img=new Image,this.tags=b,this.priority=c;var f=function(){"complete"==d.img.readyState&&(i(),e.onLoad(d))},g=function(){i(),e.onLoad(d)},h=function(){i(),e.onError(d)},i=function(){d.unbind("load",g),d.unbind("readystatechange",f),d.unbind("error",h)};this.start=function(b){e=b,d.bind("load",g),d.bind("readystatechange",f),d.bind("error",h),d.img.src=a},this.checkStatus=function(){d.img.complete&&(i(),e.onLoad(d))},this.onTimeout=function(){i(),d.img.complete?e.onLoad(d):e.onTimeout(d)},this.getName=function(){return a},this.bind=function(a,b){d.img.addEventListener?d.img.addEventListener(a,b,!1):d.img.attachEvent&&d.img.attachEvent("on"+a,b)},this.unbind=function(a,b){d.img.removeEventListener?d.img.removeEventListener(a,b,!1):d.img.detachEvent&&d.img.detachEvent("on"+a,b)}}function PxLoader(a){a=a||{},null==a.statusInterval&&(a.statusInterval=5e3),null==a.loggingDelay&&(a.loggingDelay=2e4),null==a.noProgressTimeout&&(a.noProgressTimeout=1/0);var d,b=[],c=[],e=+new Date,f={QUEUED:0,WAITING:1,LOADED:2,ERROR:3,TIMEOUT:4},g=function(a){return null==a?[]:Array.isArray(a)?a:[a]};this.add=function(a){a.tags=g(a.tags),null==a.priority&&(a.priority=1/0),b.push({resource:a,state:f.QUEUED})},this.addProgressListener=function(a,b){c.push({callback:a,tags:g(b)})},this.addCompletionListener=function(a,b){c.push({tags:g(b),callback:function(b){b.completedCount===b.totalCount&&a()}})};var h=function(a){a=g(a);var b=function(b){for(var c=b.resource,d=1/0,e=0,f=c.tags.length;f>e;e++){var g=a.indexOf(c.tags[e]);g>=0&&d>g&&(d=g)}return d};return function(a,c){var d=b(a),e=b(c);return e>d?-1:d>e?1:a.priority<c.priority?-1:a.priority>c.priority?1:0}};this.start=function(a){d=+new Date;var c=h(a);b.sort(c);for(var e=0,g=b.length;g>e;e++){var j=b[e];j.status=f.WAITING,j.resource.start(this)}setTimeout(i,100)};var i=function(){for(var c=!1,d=+new Date-e,g=d>=a.noProgressTimeout,h=d>=a.loggingDelay,j=0,k=b.length;k>j;j++){var l=b[j];l.status===f.WAITING&&(l.resource.checkStatus(),l.status===f.WAITING&&(g?l.resource.onTimeout():c=!0))}h&&c&&m(),c&&setTimeout(i,a.statusInterval)};this.isBusy=function(){for(var a=0,c=b.length;c>a;a++)if(b[a].status===f.QUEUED||b[a].status===f.WAITING)return!0;return!1};var j=function(a,b){for(var c=0,d=a.length;d>c;c++)if(b.indexOf(a[c])>=0)return!0;return!1},k=function(a,d){for(var g=null,h=0,i=b.length;i>h;h++)if(b[h].resource===a){g=b[h];break}if(null!=g&&g.status===f.WAITING){g.status=d,e=+new Date,a.tags.length;for(var h=0,m=c.length;m>h;h++){var o,n=c[h];o=0===n.tags.length?!0:j(a.tags,n.tags),o&&l(g,n)}}};this.onLoad=function(a){k(a,f.LOADED)},this.onError=function(a){k(a,f.ERROR)},this.onTimeout=function(a){k(a,f.TIMEOUT)};var l=function(a,c){for(var d=0,e=0,g=0,h=b.length;h>g;g++){var k,i=b[g];k=0===c.tags.length?!0:j(i.resource.tags,c.tags),k&&(e++,(i.status===f.LOADED||i.status===f.ERROR||i.status===f.TIMEOUT)&&d++)}c.callback({resource:a.resource,loaded:a.status===f.LOADED,error:a.status===f.ERROR,timeout:a.status===f.TIMEOUT,completedCount:d,totalCount:e})},m=this.log=function(a){if(window.console){var c=Math.round((+new Date-d)/1e3);window.console.log("PxLoader elapsed: "+c+" sec");for(var e=0,g=b.length;g>e;e++){var h=b[e];if(a||h.status===f.WAITING){var i="PxLoader: #"+e+" "+h.resource.getName();switch(h.status){case f.QUEUED:i+=" (Not Started)";break;case f.WAITING:i+=" (Waiting)";break;case f.LOADED:i+=" (Loaded)";break;case f.ERROR:i+=" (Error)";break;case f.TIMEOUT:i+=" (Timeout)"}h.resource.tags.length>0&&(i+=" Tags: ["+h.resource.tags.join(",")+"]"),window.console.log(i)}}}}}!function(a){"use strict";var d,b=function(a,b){"undefined"==typeof b&&(b={}),this.init(a,b)},c=b.prototype,e=["canvas","vml"],f=["oval","spiral","square","rect","roundRect"],g=/^\#([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$/,h=-1!==navigator.appVersion.indexOf("MSIE")&&8===parseFloat(navigator.appVersion.split("MSIE")[1])?!0:!1,i=!!document.createElement("canvas").getContext,j=40,k=!0,l=function(a,b,c){var e,d=document.createElement(a);for(e in c)d[e]=c[e];return"undefined"!=typeof b&&b.appendChild(d),d},m=function(a,b){for(var c in b)a.style[c]=b[c];return a},n=function(a,b){for(var c in b)a.setAttribute(c,b[c]);return a},o=function(a,b,c,d){a.save(),a.translate(b,c),a.rotate(d),a.translate(-b,-c),a.beginPath()};c.init=function(a,c){"boolean"==typeof c.safeVML&&(k=c.safeVML);try{this.mum=void 0!==document.getElementById(a)?document.getElementById(a):document.body}catch(f){this.mum=document.body}if(c.id="undefined"!=typeof c.id?c.id:"canvasLoader",this.cont=l("div",this.mum,{id:c.id}),i)d=e[0],this.can=l("canvas",this.cont),this.con=this.can.getContext("2d"),this.cCan=m(l("canvas",this.cont),{display:"none"}),this.cCon=this.cCan.getContext("2d");else{if(d=e[1],"undefined"==typeof b.vmlSheet){document.getElementsByTagName("head")[0].appendChild(l("style")),b.vmlSheet=document.styleSheets[document.styleSheets.length-1];var h,g=["group","oval","roundrect","fill"];for(h in g)b.vmlSheet.addRule(g[h],"behavior:url(#default#VML); position:absolute;")}this.vml=l("group",this.cont)}this.setColor(this.color),this.draw(),m(this.cont,{display:"none"})},c.cont={},c.can={},c.con={},c.cCan={},c.cCon={},c.timer={},c.activeId=0,c.diameter=40,c.setDiameter=function(a){this.diameter=Math.round(Math.abs(a)),this.redraw()},c.getDiameter=function(){return this.diameter},c.cRGB={},c.color="#000000",c.setColor=function(a){this.color=g.test(a)?a:"#000000",this.cRGB=this.getRGB(this.color),this.redraw()},c.getColor=function(){return this.color},c.shape=f[0],c.setShape=function(a){var b;for(b in f)if(a===f[b]){this.shape=a,this.redraw();break}},c.getShape=function(){return this.shape},c.density=40,c.setDensity=function(a){this.density=k&&d===e[1]?Math.round(Math.abs(a))<=j?Math.round(Math.abs(a)):j:Math.round(Math.abs(a)),this.density>360&&(this.density=360),this.activeId=0,this.redraw()},c.getDensity=function(){return this.density},c.range=1.3,c.setRange=function(a){this.range=Math.abs(a),this.redraw()},c.getRange=function(){return this.range},c.speed=2,c.setSpeed=function(a){this.speed=Math.round(Math.abs(a))},c.getSpeed=function(){return this.speed},c.fps=24,c.setFPS=function(a){this.fps=Math.round(Math.abs(a)),this.reset()},c.getFPS=function(){return this.fps},c.getRGB=function(a){return a="#"===a.charAt(0)?a.substring(1,7):a,{r:parseInt(a.substring(0,2),16),g:parseInt(a.substring(2,4),16),b:parseInt(a.substring(4,6),16)}},c.draw=function(){var b,c,g,i,j,k,p,q,t,v,w,x,y,a=0,r=this.density,s=Math.round(r*this.range),u=0,z=1e3,A=0,B=this.cCon,C=this.diameter,D=.47;if(d===e[0])for(B.clearRect(0,0,z,z),n(this.can,{width:C,height:C}),n(this.cCan,{width:C,height:C});r>a;){switch(t=s>=a?1-(1-u)/s*a:t=u,k=270-360/r*a,p=k/180*Math.PI,B.fillStyle="rgba("+this.cRGB.r+","+this.cRGB.g+","+this.cRGB.b+","+t.toString()+")",this.shape){case f[0]:case f[1]:b=.07*C,i=C*D+Math.cos(p)*(C*D-b)-C*D,j=C*D+Math.sin(p)*(C*D-b)-C*D,B.beginPath(),this.shape===f[1]?B.arc(.5*C+i,.5*C+j,b*t,0,2*Math.PI,!1):B.arc(.5*C+i,.5*C+j,b,0,2*Math.PI,!1);break;case f[2]:b=.12*C,i=Math.cos(p)*(C*D-b)+.5*C,j=Math.sin(p)*(C*D-b)+.5*C,o(B,i,j,p),B.fillRect(i,j-.5*b,b,b);break;case f[3]:case f[4]:c=.3*C,g=.27*c,i=Math.cos(p)*(g+.13*(C-g))+.5*C,j=Math.sin(p)*(g+.13*(C-g))+.5*C,o(B,i,j,p),this.shape===f[3]?B.fillRect(i,j-.5*g,c,g):(q=.55*g,B.moveTo(i+q,j-.5*g),B.lineTo(i+c-q,j-.5*g),B.quadraticCurveTo(i+c,j-.5*g,i+c,j-.5*g+q),B.lineTo(i+c,j-.5*g+g-q),B.quadraticCurveTo(i+c,j-.5*g+g,i+c-q,j-.5*g+g),B.lineTo(i+q,j-.5*g+g),B.quadraticCurveTo(i,j-.5*g+g,i,j-.5*g+g-q),B.lineTo(i,j-.5*g+q),B.quadraticCurveTo(i,j-.5*g,i+q,j-.5*g))}B.closePath(),B.fill(),B.restore(),++a}else{switch(m(this.cont,{width:C,height:C}),m(this.vml,{width:C,height:C}),this.shape){case f[0]:case f[1]:x="oval",b=.14*z;break;case f[2]:x="roundrect",b=.12*z;break;case f[3]:case f[4]:x="roundrect",b=.3*z}for(c=g=b,i=.5*z-g,j=.5*-g;r>a;){switch(t=s>=a?1-(1-u)/s*a:t=u,k=270-360/r*a,this.shape){case f[1]:c=g=b*t,i=.5*z-.5*b-.5*b*t,j=.5*(b-b*t);break;case f[0]:case f[2]:h&&(j=0,this.shape===f[2]&&(i=.5*z-.5*g));break;case f[3]:case f[4]:c=.95*b,g=.28*c,h?(i=0,j=.5*z-.5*g):(i=.5*z-c,j=.5*-g),A=this.shape===f[4]?.6:0}w=n(m(l("group",this.vml),{width:z,height:z,rotation:k}),{coordsize:z+","+z,coordorigin:.5*-z+","+.5*-z}),v=m(l(x,w,{stroked:!1,arcSize:A}),{width:c,height:g,top:j,left:i}),y=l("fill",v,{color:this.color,opacity:t}),++a}}this.tick(!0)},c.clean=function(){if(d===e[0])this.con.clearRect(0,0,1e3,1e3);else{var a=this.vml;if(a.hasChildNodes())for(;a.childNodes.length>=1;)a.removeChild(a.firstChild)}},c.redraw=function(){this.clean(),this.draw()},c.reset=function(){"number"==typeof this.timer&&(this.hide(),this.show())},c.tick=function(a){var b=this.con,c=this.diameter;a||(this.activeId+=360/this.density*this.speed),d===e[0]?(b.clearRect(0,0,c,c),o(b,.5*c,.5*c,this.activeId/180*Math.PI),b.drawImage(this.cCan,0,0,c,c),b.restore()):(this.activeId>=360&&(this.activeId-=360),m(this.vml,{rotation:this.activeId}))},c.show=function(){if("number"!=typeof this.timer){var a=this;this.timer=self.setInterval(function(){a.tick()},Math.round(1e3/this.fps)),m(this.cont,{display:"block"})}},c.hide=function(){"number"==typeof this.timer&&(clearInterval(this.timer),delete this.timer,m(this.cont,{display:"none"}))},c.kill=function(){var a=this.cont;"number"==typeof this.timer&&this.hide(),d===e[0]?(a.removeChild(this.can),a.removeChild(this.cCan)):a.removeChild(this.vml);var b;for(b in this)delete this[b]},a.CanvasLoader=b}(window),Array.isArray||(Array.isArray=function(a){return"[object Array]"==Object.prototype.toString.call(a)}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>0&&(d=Number(arguments[1]),d!=d?d=0:0!=d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),PxLoader.prototype.addImage=function(a,b,c){var d=new PxLoaderImage(a,b,c);return this.add(d),d.img},function(a){function f(a){var b=[],c=b.slice;return c.call(arguments,1).forEach(function(b){for(var c in b)a[c]=b[c]}),a}function g(a){this.isLock=!1,f(this,e,a),this.diffY=Math.ceil(this.height*(g.sh/g.sw-1)),this.y+=this.diffY*this.row,this.dropHeight=0}var c=7,d=7,e={x:0,y:0,width:45,height:45,row:0,col:0,img:null,ctx:null};g.sw=90,g.sh=96,g.animalNum=6,g.getRandom=function(a){var b=parseInt(Math.random()*g.animalNum,10);return b===a?(b+1)%g.animalNum:b},g.prototype={show:function(){this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY)},destroy:function(){this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY)},update:function(){if(this.isLock){if(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.dropHeight>0)this.dropHeight-=this.dropDiffHeight,this.dropHeight<=0?(this.isLock=!1,this.dropHeight=0,this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y-this.dropHeight,this.width,this.height+this.diffY)):this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y-this.dropHeight,this.width,this.height+this.diffY);else if(this.scale)this.scale+=4,this.scale<this.width/2?this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x+this.scale,this.y+this.scale,this.width-2*this.scale,this.height-2*this.scale+this.diffY):(this.scale=0,this.img=[g.getRandom(this.img[0]),1],this.magnify=parseInt(this.width/4,10));else if(this.shake){this.shake-=1;var a=0===this.shake%2?-1:1;this.shake>0?this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x+a,this.y+a,this.width,this.height+this.diffY):(this.shake=0,this.animScale())}else if(this.magnify)this.magnify-=2,this.magnify<0&&(this.magnify=0),this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x+this.magnify/2,this.y+this.magnify/2,this.width-this.magnify,this.height-this.magnify+this.diffY),0===this.magnify&&(this.isLock=!1);else if(this.mouse)if(this.mouse.repeat<=0){var b=g.prototype[this.mouse.direct].call(this);this.isLock=!1,b?b.animMouse(this.mouse.direct,this.mouse.callback):this.mouse.callback.call(this),this.mouse=null}else{var c;c="bottom"==this.mouse.direct?g.mouseImgArr[this.mouse.step]:g.frogImgArr[this.mouse.step],this.ctx.drawImage(c,this.x,this.y,this.width,this.height+this.diffY),this.mouse.step++,this.mouse.step>=3&&(this.mouse.repeat--,this.mouse.step=0)}}else this.star?this.star.count<=this.star.max?(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.starsArr[this.star.count],this.x,this.y,this.width,this.height+this.diffY),this.star.count+=this.star.step):(this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY),this.star.callback&&this.star.callback(),this.star=null):this.boom?this.boom.count<=this.boom.max?(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.boomArr[this.boom.count%2],this.x,this.y,this.width+this.boom.max-this.boom.count,this.height+this.diffY+this.boom.max-this.boom.count),this.boom.count+=this.boom.step):(this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY),this.boom.callback&&this.boom.callback(),this.boom=null):this.booming?this.booming.count<=this.booming.max?(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.booming.count>this.booming.startBoomed?this.ctx.drawImage(g.boomed,this.x,this.y,this.width,this.height+this.diffY):this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY),this.booming.count<=this.booming.boomingMax&&this.ctx.drawImage(g.boomingArr[parseInt(this.booming.count,10)],this.x,this.y,this.width,this.height+this.diffY),this.booming.count+=this.booming.step):(this.booming.callback&&this.booming.callback(),this.booming=null):this.bigboom?this.bigboom.count<=this.bigboom.max?(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.bigboomArr[this.bigboom.count%2],this.x,this.y,this.width,this.height+this.diffY),this.bigboom.count+=this.bigboom.step):(this.bigboom.callback&&this.bigboom.callback(),this.bigboom=null):this.disappear?this.disappear.count<this.disappear.max?(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.disappearArr[this.disappear.count],this.x,this.y,this.width,this.height+this.diffY),this.disappear.count+=this.disappear.step):(this.disappear.callback&&this.disappear.callback(),this.disappear=null):this.isRedraw&&(this.ctx.clearRect(this.x,this.y,this.width,this.height+this.diffY),this.ctx.drawImage(g.imgArr[this.img[0]][this.img[1]],this.x,this.y,this.width,this.height+this.diffY),this.isRedraw=!1)},setRedraw:function(){this.isRedraw=!0},animScale:function(){this.isLock=!0,this.scale=1},animDrop:function(a){this.isLock=!0,this.dropDiffHeight=parseInt(this.height/4,10),this.dropCallBack=a},animMouse:function(a,b){this.isLock=!0,this.mouse={direct:a,repeat:1,callback:b,step:0}},animStar:function(a){this.star={count:1,max:15,step:1,callback:a}},animBoom:function(a){this.boom={count:1,max:15,step:1,callback:a}},animBooming:function(a){this.booming={count:0,max:9,boomingMax:6,startBoomed:3,step:.5,callback:a}},animBigboom:function(a){this.bigboom={count:1,max:15,step:1,callback:a}},animDisappear:function(a){this.disappear={count:1,max:11,step:1,callback:a}},animShake:function(){this.isLock=!0,this.shake=20},setState:function(a){this.img[1]=a},getState:function(){return this.img[1]},setImgIndex:function(a){this.img[0]=a},getImgIndex:function(){return this.img[0]},getLock:function(){return this.isLock},top:function(){return this.row-1>=0?g.cells[this.row-1][this.col]:null},bottom:function(){return this.row+1<c?g.cells[this.row+1][this.col]:null},left:function(){return this.col-1>=0?g.cells[this.row][this.col-1]:null},right:function(){return this.col+1<d?g.cells[this.row][this.col+1]:null}},a.Cell=g}(window),function(a){function D(a){for(var b=0;d>b;b++){a[b]=[];for(var c=0;d>c;c++)a[b][c]=0}}function E(a){var b=a.pageX,c=a.pageY;("touchstart"===a.type||"touchend"===a.type)&&(b=a.touches[0].pageX,c=a.touches[0].pageY);for(var d=a.target,e=d.offsetTop,f=d.offsetLeft;d=d.offsetParent;)e+=d.offsetTop,f+=d.offsetLeft;return{x:b-f,y:c-e}}function F(a){return Cell.cells[Math.floor(a.y/(C+Cell.cells[0][0].diffY))][Math.floor(a.x/C)]}function G(b){return b=b||60,a.requestAnimationFrame||a.mozRequestAnimationFrame||a.webkitRequestAnimationFrame||a.msRequestAnimationFrame||a.oRequestAnimationFrame||function(c){a.setTimeout(c,1e3/b)}}function H(){for(var a=Cell.cells.length,b=0;a>b;b++)for(var c=Cell.cells[b].length,d=0;c>d;d++)if(Cell.cells[b][d].getLock())return!0;return!1}function I(a,b){var e,f,g,c=[];return c.push(a),h[a.row][a.col]=1,a.row+1<d&&2!==b&&(e=a.row+1,f=a.col,g=Cell.cells[e][f],g.getLock()||g.getImgIndex()!==a.getImgIndex()||0!==h[e][f]||(c=c.concat(I(g,0)))),a.col+1<d&&1!==b&&(e=a.row,f=a.col+1,g=Cell.cells[e][f],g.getLock()||g.getImgIndex()!==a.getImgIndex()||0!==h[e][f]||(c=c.concat(I(g,3)))),a.row-1>=0&&0!==b&&(e=a.row-1,f=a.col,g=Cell.cells[e][f],g.getLock()||g.getImgIndex()!==a.getImgIndex()||0!==h[e][f]||(c=c.concat(I(g,2)))),a.col-1>=0&&3!==b&&(e=a.row,f=a.col-1,g=Cell.cells[e][f],g.getLock()||g.getImgIndex()!==a.getImgIndex()||0!==h[e][f]||(c=c.concat(I(g,1)))),c}function J(){D(i);for(var b,a=Cell.cells.length,c=0;a>c;c++)for(var d=Cell.cells[c].length,e=0;d>e;e++)if(D(h),b=I(Cell.cells[c][e]),i[c][e]=b.length,i[c][e]>2)return!1;return!0}function K(a){var b,c,e,f,g,h,i,j;a=a||2;for(var k=0;a>k;k++)e=0,b=parseInt(Math.random()*d,10),c=parseInt(Math.random()*d,10),j=Cell.cells[b][c],f=j.top(),g=j.left(),h=j.right(),i=j.bottom(),2>e&&f&&(f.img[0]=j.img[0],f.img[1]=j.img[1],f.setRedraw(),e++),2>e&&h&&(h.img[0]=j.img[0],h.img[1]=j.img[1],h.setRedraw(),e++),2>e&&i&&(i.img[0]=j.img[0],i.img[1]=j.img[1],i.setRedraw(),e++),2>e&&g&&(g.img[0]=j.img[0],g.img[1]=j.img[1],g.setRedraw(),e++)}function L(a){var b=parseInt(a/1e4),c=parseInt(a/1e3%10);0==b&&1==c%2?(s[0].className="time_bg time_num_"+b+"_red",s[1].className="time_bg time_num_"+c+"_red"):(s[0].className="time_bg time_num_"+b,s[1].className="time_bg time_num_"+c)}function M(a){if(a)p.run.toolsWarning.push(function(){document.getElementById("messagebox_tool").style.background="url('img/item/"+a.img+".png') no-repeat",document.getElementById("messagebox_tool").style.backgroundSize="45px 51px",document.getElementById("messagebox_tool_text").innerHTML=a.text}),M();else if(p.run.toolsEventIndex<p.run.toolsWarning.length){if(document.getElementById("div_messagebox").style.display="block",document.getElementById("control_panel").style.opacity="0.3",1==p.run.toolAlerting)return;p.run.toolsWarning[p.run.toolsEventIndex]()}}function N(a){document.getElementById("control_panel").style.opacity="0.3",document.getElementById("messagebox_tool").style.background="url('img/item/"+a.img+".png') no-repeat",document.getElementById("messagebox_tool").style.backgroundSize="45px 51px",document.getElementById("messagebox_tool_text").innerHTML=a.text,document.getElementById("div_messagebox").style.display="block",document.getElementById("control_panel").style.opacity="0.3",p.run.toolAlerting=1,setTimeout(function(){document.getElementById("div_messagebox").style.display="none",document.getElementById("control_panel").style.opacity="1",p.run.toolAlerting=0,M()},1e3),M()}function P(a){if(O!=a){O=a;var b="<span class='score_bg score_num_",c="'></span>";if(0>=a)return v.innerHTML=b+0+c,void 0;for(var d=b+parseInt(a%10)+c,e=10,f=parseInt(a/e);f;)d=b+f%10+c+d,e=10*e,f=parseInt(a/e);v.innerHTML=d}}function S(a){a?(document.getElementById("screen_resume_diffheight_div").style.display="block",document.getElementById("resume").style.display="block",document.getElementById("screen_prize_span").style.display="none"):(document.getElementById("screen_resume_diffheight_div").style.display="none",document.getElementById("resume").style.display="none",document.getElementById("screen_prize_span").style.display="block",document.getElementById("final_score_div").innerHTML=document.getElementById("span_score").innerHTML),Q()}function T(){R()}function U(){t.style.display="none",u.style.display="none",document.querySelector("header").style.display="none",document.getElementById("div_messagebox").style.display="none",document.getElementById("control_panel").style.opacity="1",document.getElementById("main").style.display="none",document.querySelector(".entrance").style.display="block",document.getElementById("div_screen").style.display="none"}function V(){document.querySelector("header").style.display="block",document.getElementById("main").style.display="block",document.querySelector(".entrance").style.display="none"}function X(){var b,c,d,e,f,g,h;return a.innerHeight&&a.scrollMaxY?(b=document.body.scrollWidth,c=a.innerHeight+a.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(b=document.body.scrollWidth,c=document.body.scrollHeight):(b=document.body.offsetWidth,c=document.body.offsetHeight),self.innerHeight?(g=self.innerWidth,h=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(g=document.documentElement.clientWidth,h=document.documentElement.clientHeight):document.body&&(g=document.body.clientWidth,h=document.body.clientHeight),d=h>c?h:c,e=g>b?g:b,f=[e,d,g,h]}function Y(c){var f,g,e=X();A=z.getContext("2d"),f=Math.min(e[0],e[1]),g=Math.max(e[0],e[1]),f=320,C=45,z.width=C*d,z.height=z.width+C*(Cell.sh/Cell.sw-1)*d;var h=z.width,i=z.height,j=h,k=i;z.width=h*a.devicePixelRatio,z.height=i*a.devicePixelRatio,z.style.width=j+"px",z.style.height=k+"px",A.scale(a.devicePixelRatio,a.devicePixelRatio);var l=e[1]-z.height;l=57,z.style.marginTop=l+"px";var m=document.querySelector("header");if(m.style.height=l+"px",m.style.visibility="visible",s=document.querySelectorAll(".time_bg"),v=document.getElementById("span_score"),w=document.getElementById("div_messagebox"),w.style.left=document.getElementById("span_messagebox").offsetLeft+"px",w.style.top=document.getElementById("span_messagebox").offsetTop-4+"px",x.dom=document.getElementById("div_screen"),x.dom.style.left=document.getElementById("control_panel").offsetLeft+"px",x.dom.style.top=l-x.height+"px",x.dom.style.display="block",Q=function(a){return function(){a.dom.style.top="0px"}}(x,l,a),R=function(a,b){return function(){a.dom.style.top=b+"px"}}(x,l-x.height,a),!q){q=new CanvasLoader("main"),q.setColor("#59aceb"),q.setShape("spiral"),q.setDiameter(83),q.setDensity(29),q.setFPS(27);var n=document.getElementById("canvasLoader");n.style.position="absolute",n.style.top=l+z.height/4-30+"px",n.style.left=(e[0]-f)/2+z.width/4-30+"px"}q.show(),t.style.top=document.getElementById("control_panel").offsetTop+31+"px",t.style.left=document.getElementById("control_panel").offsetLeft+28+"px",t.style.display="block",u.style.top=document.getElementById("control_panel").offsetTop+31+"px",u.style.left=document.getElementById("control_panel").offsetLeft+251+"px",u.style.display="block",b.init({skin:c})}function Z(a){function d(a){for(var b=a.top();b;)a.img[0]=b.img[0],a.img[1]=b.img[1],a.dropHeight+=a.height,a.animDrop(),a=b,b=a.top();a.dropHeight+=a.height,a.setImgIndex(Cell.getRandom()),a.animDrop()}dropLock=!0,a.sort(function(a,b){return a.col-b.col}),a.sort(function(a,b){return a.row-b.row});for(var c=0;c<a.length;c++)d(a[c]);setTimeout(function(){p.run.dropLock=!1},1e3)}function $(a,b,c){for(var d=0;d<a.length-1;d++)a[d].animStar();b?a[a.length-1].animStar(b):a[a.length-1].animStar(function(b){return function(){setTimeout(function(){Z(a),b()},100)}}(c))}function _(a,b,c){b?a.animBoom(b):a.animBoom(function(a){return function(){setTimeout(function(){Z(cells),a()},100)}}(c))}function ab(a,b,c){for(var d=0;d<a.length-1;d++)a[d].animBooming();b?a[a.length-1].animBooming(b):a[a.length-1].animBooming(function(b){return function(){setTimeout(function(){Z(a),b()},100)}}(c))}function bb(a,b,c){for(var d=0;d<a.length-1;d++)a[d].animBigboom();b?a[a.length-1].animBigboom(b):a[a.length-1].animBigboom(function(b){return function(){setTimeout(function(){Z(a),b()},100)}}(c))}function cb(a,b){a.addEventListener("mousedown",b,!1),a.addEventListener("touchstart",b,!1)}function db(){}var q,s,t,u,v,w,y,z,A,C,Q,R,b={},c={ranking:{total:{id:1}}},d=7,e=1,f=[],g=3,h=[],i=[],j=6e4,k=0,l=j,m=0,n=100,o=0,p={config:{randomFresh:{time:5e3},deadDetect:{time:1e3},crab:{img:3,bouns:900,combo:8,count:document.getElementById("crab_count"),text:"\u4e00\u6b21\u70b89\u4e2a\u5462\uff0c</br>\u5feb\u70b9\u4f7f\u7528\u5427!"},frog:{img:4,bouns:1200,combo:11,count:document.getElementById("frog_count"),text:"\u5403\u4e00\u7ad6\u6392\u5462\uff0c</br>\u5feb\u70b9\u4f7f\u7528\u5427!"},elephant:{img:1,bouns:1200,combo:11,count:document.getElementById("elephant_count"),text:"\u5403\u4e00\u6a2a\u6392\u5462\uff0c</br>\u5feb\u70b9\u4f7f\u7528\u5427!"},chick:{img:5,bouns:1500,combo:14,count:document.getElementById("chick_count"),increase:1e4,text:"\u53fd\u53fd\u53fd\u53fd\u53fd\uff0c</br>\u589e\u52a0\u65f6\u95f4\u54af!"},bat:{img:0,bouns:1500,combo:14,count:document.getElementById("bat_count"),text:"\u70b9\u8c01\u8c01\u5c3188\uff0c</br>\u5feb\u70b9\u4f7f\u7528\u5427!"},fox:{img:2,bouns:3e3,combo:24,count:document.getElementById("fox_count"),text:"\u795e\u4e86\u70b8\u597d\u591a\uff0c</br>\u5feb\u70b9\u4f7f\u7528\u5427!"},pig:{img:6,format:[[[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1]],[[6,1],,[6,1],,[6,1],,[6,1]],[[6,1],[6,1],,,,[6,1],[6,1]],[[6,1],,,,,,[6,1]],[[6,1],,[6,1],[6,1],[6,1],,[6,1]],[[6,1],,[6,1],,[6,1],,[6,1]],[[6,1],[6,1],[6,1],[6,1],[6,1],[6,1],[6,1]]],bouns:3600,combo:35,count:document.getElementById("pig_count"),text:"\u56e7\u6b7b\u4f60\u554a\u554a\uff0c</br>\u56e7\u554a\u56e7\u554a!"},panda:{img:7,bouns:4500,combo:44,count:document.getElementById("panda_count"),text:"\u5168\u5c4f\u6e05\u9664\uff0c</br>\u8fd8\u52a0\u5206!"}},run:function(){var a={},b={crab:{count:0,clear:0},frog:{count:0,clear:0},elephant:{count:0,clear:0},chick:{count:0,clear:0},bat:{count:0,clear:0},fox:{run:0,count:0,clear:0},pig:{count:0,clear:0},panda:{count:0,clear:0},randomFresh:{time:0},deadDetect:{time:0},toolAlerting:0,toolsEvent:[],toolsWarning:[],toolsEventIndex:0,toolsEventLock:!1,dropLock:!1,toolsEventAutoUnlock:null};return a.reStore=function(){for(var c in b)a[c]=JSON.parse(JSON.stringify(b[c]));return a},a.reStore()}()},r=!0,x={dom:null,height:381,uping:null,downing:null},B=!1,O=-1;b.init=function(a){var c=new PxLoader;Cell.imgArr=[],Cell.cells=[];for(var f=0;f<Cell.animalNum;f++){Cell.imgArr[f]=[];for(var g=1;e>=g;g++)Cell.imgArr[f][g]=c.addImage("img/"+a.skin+"/"+f+g+".png")}Cell.mouseImgArr=[],Cell.mouseImgArr[0]=c.addImage("img/mouse1.png"),Cell.mouseImgArr[1]=c.addImage("img/mouse2.png"),Cell.mouseImgArr[2]=c.addImage("img/mouse3.png"),Cell.mouseImgArr[3]=c.addImage("img/mouse4.png"),Cell.mouseImgArr[4]=c.addImage("img/mouse5.png"),Cell.mouseImgArr[5]=c.addImage("img/mouse6.png"),Cell.mouseImgArr[6]=c.addImage("img/mouse7.png"),Cell.mouseImgArr[7]=c.addImage("img/mouse8.png"),Cell.starsArr=[];for(var f=1;16>f;f++)Cell.starsArr[f]=c.addImage("img/stars/"+f+".png");Cell.boomArr=[c.addImage("img/boom/boom0.png"),c.addImage("img/boom/boom1.png")],Cell.boomingArr=[];for(var f=0;7>f;f++)Cell.boomingArr[f]=c.addImage("img/boom/booming"+f+".png");Cell.boomed=c.addImage("img/boom/boomed.png"),Cell.bigboomArr=[c.addImage("img/boom/bigboom0.png"),c.addImage("img/boom/bigboom1.png")],Cell.disappearArr=[];for(var f=0;11>f;f++)Cell.disappearArr[f]=c.addImage("img/disappear/"+f+".png");Cell.frogImgArr=[],Cell.frogImgArr[0]=c.addImage("img/mouse1.png"),Cell.frogImgArr[1]=c.addImage("img/mouse2.png"),Cell.frogImgArr[2]=c.addImage("img/mouse3.png"),Cell.frogImgArr[3]=c.addImage("img/mouse4.png"),Cell.frogImgArr[4]=c.addImage("img/mouse5.png"),Cell.frogImgArr[5]=c.addImage("img/mouse6.png"),Cell.frogImgArr[6]=c.addImage("img/mouse7.png"),Cell.frogImgArr[7]=c.addImage("img/mouse8.png"),c.addCompletionListener(function(){console.log(C),q.hide();for(var a=0;d>a;a++){Cell.cells[a]=[];for(var c=0;d>c;c++)Cell.cells[a][c]=new Cell({img:[Cell.getRandom(),1],ctx:A,height:C,width:C,x:c*C,y:a*C,row:a,col:c}),Cell.cells[a][c].show()}b.reStart()}),c.start()},b.stop=function(){document.getElementById("div_messagebox").style.display="none",document.getElementById("control_panel").style.opacity="1",this.stoped=!0},b.pause=function(){document.getElementById("div_messagebox").style.display="none",document.getElementById("control_panel").style.opacity="1",this.paused=!0},b.resume=function(){M(),this.paused=!1},b.refresh=function(){for(var b,c,e,a=2,f=0;a>f;f++)b=parseInt(Math.random()*d,10),c=parseInt(Math.random()*d,10),e=Cell.cells[b][c],e.getLock()||(e.setImgIndex(Cell.getRandom()),e.setRedraw())},b.refreshAll=function(){for(var a=Cell.cells.length,b=0;a>b;b++)for(var c=Cell.cells[b].length,d=0;c>d;d++)Cell.cells[b][d].setImgIndex(Cell.getRandom()),Cell.cells[b][d].setRedraw()},b.clearSameColor=function(a){for(var b=0,c=Cell.cells.length,d=[],e=0;c>e;e++)for(var f=Cell.cells[e].length,g=0;f>g;g++)Cell.cells[e][g].getImgIndex()===a.getImgIndex()&&(Cell.cells[e][g].getLock()||d.push(Cell.cells[e][g]),b++);$(d,null,function(){setTimeout(function(){p.run.toolsEventLock=!1},400)}),m+=n*b},b.clearAll=function(){for(var a=Cell.cells.length,b=0;a>b;b++)for(var c=Cell.cells[b].length,d=0;c>d;d++)Cell.cells[b][d].getLock()||Cell.cells[b][d].animScale()},b.reStart=function(){document.getElementById("div_messagebox").style.display="none",document.getElementById("control_panel").style.opacity="1",this.paused=!1,b.stop(),function(){var c=arguments.callee;a.setTimeout(function(){r?b.start():c.call(b)},100)}()},b.start=function(){f=[],r=!1,this.stoped=!1,this.paused=!1,L(l),P(0),m=0,p.run.reStore(),l=j,k=0;var s,e=G(),i=Date.now();e(function(k){var k=Date.now();if(b.stoped&&!H())return r=!0,void 0;if(s=k-i,s>=32){if(o++,!b.paused){p.run.toolsEventLock||p.run.dropLock||(l-=s),0>=l&&(l=0,b.stop(),a.setTimeout(function(){S(),db(c.ranking.total.id,m)},1500),L(l)),p.run.randomFresh.time+=s,p.run.randomFresh.time>=p.config.randomFresh.time&&(p.run.randomFresh.time=0),p.run.deadDetect.time+=s,p.run.deadDetect.time>=p.config.deadDetect.time&&(L(l),p.run.deadDetect.time=0,J()&&K()),function(){for(var a in p.config){var b=p.config[a];b.count&&(b.count.innerHTML=p.run[a].clear)}}();for(var q=f.pop();q&&q.cell;){if(D(h),!p.run.toolsEventLock&&p.run.toolsEventIndex<p.run.toolsEvent.length&&!p.run.dropLock){p.run.toolsEventLock=!0,p.run.toolsEventAutoUnlock||clearTimeout(p.run.toolsEventAutoUnlock),p.run.toolsEventAutoUnlock=setTimeout(function(){p.run.toolsEventLock=!1},4e3),p.run.toolsEventIndex++,p.run.toolsEvent[p.run.toolsEventIndex-1](q,p.run),p.run.toolsEventIndex<p.run.toolsWarning.length?M():(document.getElementById("div_messagebox").style.display="none",document.getElementById("control_panel").style.opacity="1");break}if(!p.run.toolsEventLock&&!p.run.dropLock){if(!q.cell.getLock()){var t=I(q.cell),u=t.length;if(u>=g){if(6==t[0].img[0]&&t.length>15)p.run.pig.clear=p.run.pig.clear+1;else for(v=0;u>v;v++)!function(){var a=t[v].img[0];for(var b in p.config){var c=p.config[b];c.img==a&&p.run[b].clear++}}();if(p.run.fox.clear>p.config.fox.combo&&(p.run.fox.clear-=p.config.fox.combo,M(p.config.fox),p.run.toolsEvent.push(function(a){var c=I(a.cell),e=c.length;!function(){function m(b){for(var c=0;c<a.length;c++)if(a[c][0]==b[0]&&a[c][1]==b[1])return;a.push(b)}for(var a=[],b=0;e>b;b++){var f=c[b],g=f.col,h=f.row;m([h,g]);for(var i=-1;2>i;i++){var j=g+i;if(j>-1&&d>j)for(var k=-1;2>k;k++){var l=h+k;l>-1&&d>l&&m([l,j])}}}c=[];for(var g=0;g<a.length;g++)c.push(Cell.cells[a[g][0]][a[g][1]]);
return a.length}(),m+=p.config.fox.bouns,m+=e*n,bb(c,null,function(){setTimeout(function(){p.run.toolsEventLock=!1},400)})})),10>u&&p.run.pig.clear>p.config.pig.combo)p.run.pig.clear-=p.config.pig.combo,N(p.config.pig),function(){for(var a=0;a<p.config.pig.format.length;a++)for(var b=0;b<p.config.pig.format[a].length;b++){var c=p.config.pig.format[a][b];c&&(Cell.cells[a][b].img[0]=c[0],Cell.cells[a][b].img[1]=c[1],Cell.cells[a][b].setRedraw())}}(),m+=p.config.pig.bouns;else{for(var v=0;u-1>v;v++)p.run.toolsEventLock=!0,t[v].animDisappear();t[u-1].animDisappear(function(){Z(t),setTimeout(function(){p.run.toolsEventLock=!1},400)}),m+=u*n}}}break}q=f.pop()}P(m),p.run.crab.clear>p.config.crab.combo&&(p.run.crab.clear-=p.config.crab.combo,M(p.config.crab),p.run.toolsEvent.push(function(a){for(var b=[],c=a.cell.col,d=a.cell.row,e=Cell.cells.length,f=-1;2>f;f++){var g=c+f;if(g>-1&&e>g)for(var h=-1;2>h;h++){var i=d+h;i>-1&&e>i&&b.push(Cell.cells[i][g])}}_(a.cell,function(a,b,c){return function(){a(b,null,c)}}(ab,b,function(){setTimeout(function(){p.run.toolsEventLock=!1},400)})),m+=p.config.crab.bouns})),p.run.frog.clear>p.config.frog.combo&&(p.run.frog.clear-=p.config.frog.combo,M(p.config.frog),p.run.toolsEvent.push(function(a){Cell.cells[Cell.cells.length-1][a.cell.col].animMouse("top",function(){for(var a=[],b=0;b<Cell.cells.length;b++)a.push(Cell.cells[b][this.col]);Z(a),setTimeout(function(){p.run.toolsEventLock=!1},400)}),m+=n*d,m+=p.config.frog.bouns})),p.run.elephant.clear>p.config.elephant.combo&&(p.run.elephant.clear-=p.config.elephant.combo,M(p.config.elephant),p.run.toolsEvent.push(function(a){Cell.cells[a.cell.row][0].animMouse("right",function(){Z(Cell.cells[this.row]),setTimeout(function(){p.run.toolsEventLock=!1},400)}),m+=n*d,m+=p.config.elephant.bouns})),p.run.bat.clear>p.config.bat.combo&&(p.run.bat.clear-=p.config.bat.combo,M(p.config.bat),p.run.toolsEvent.push(function(a){b.clearSameColor(a.cell),m+=p.config.bat.bouns})),p.run.chick.clear>p.config.chick.combo&&(p.run.chick.clear-=p.config.chick.combo,l+p.config.chick.increase>j?l=j:l+=p.config.chick.increase,m+=p.config.chick.bouns,N(p.config.chick)),p.run.panda.clear>p.config.panda.combo&&(N(p.config.panda),p.run.panda.clear-=p.config.panda.combo,b.clearAll(),m+=p.config.panda.bouns,m+=n*d*d);var w=Cell.cells.length;for(v=0;w>v;v++)for(var x=Cell.cells[v].length,y=0;x>y;y++)Cell.cells[v][y].update()}i=k}e(arguments.callee)})},function(){z=document.getElementById("canvas"),t=document.getElementById("btn_pause"),u=document.getElementById("div_timer"),cb(z,function(a){B||p.run.toolsEventLock||(B=!0,setTimeout(function(){B=!1},200),b.paused||f.push({cell:F(E(a)),e:a}))}),cb(t,function(){b.paused||(l>0&&b.pause(),S(l>0))});var a=document.getElementById("resume"),c=document.getElementById("restart"),d=document.getElementById("quit");cb(a,function(){b.resume(),T()}),cb(c,function(){b.refreshAll(),b.reStart(),T()}),cb(d,function(){try{T(),U()}catch(b){}}),y=document.getElementById("help_div"),y.style.left=document.getElementById("mainMenu").offsetLeft+"px",y.style.top="0px";var e=document.getElementById("oneminute"),g=document.getElementById("night"),h=document.getElementById("about"),i=document.getElementById("help");cb(e,function(){V(),Y("140150")}),cb(g,function(){V(),Y("night")}),cb(h,function(){y.style.display="block",document.getElementById("help_div_about_us").style.display="block"}),cb(i,function(){y.style.display="block",document.getElementById("help_div_0").style.display="block"}),cb(document.getElementById("divScreenHelpBtn"),function(){y.style.display="block",document.getElementById("help_div_0").style.display="block"}),localStorage.notFristInit||(localStorage.notFristInit=!0,y.style.display="block",document.getElementById("help_div_0").style.display="block"),cb(document.getElementById("divScreenBodyHelpBtn"),function(){y.style.display="block",document.getElementById("help_div_0").style.display="block"}),cb(y,function(){"block"==document.getElementById("help_div_0").style.display?(document.getElementById("help_div_0").style.display="none",document.getElementById("help_div_1").style.display="block"):("block"==document.getElementById("help_div_1").style.display||"block"==document.getElementById("help_div_about_us").style.display||"block"==document.getElementById("help_div_ranking").style.display)&&(y.style.display="none",document.getElementById("help_div_1").style.display="none",document.getElementById("help_div_about_us").style.display="none",document.getElementById("help_div_ranking").style.display="none")})}(),function(a,b){a.style.background="url('img/light"+b+".png') no-repeat",a.style.backgroundSize="157px 54px",setTimeout(function(a,b,c){return function(){a(b,1==c?2:1)}}(arguments.callee,a,b),150)}(document.getElementById("div_messagebox"),1)}(window);